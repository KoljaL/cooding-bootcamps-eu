<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="./img/favicon-dark.png" type="image/png" sizes="16x16">
  <title>Web Apps Foundation</title>
  <script>
    var dataTheme;
    dataTheme = window.localStorage.getItem('data-theme') || '';
    if (!dataTheme) {
      dataTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
    }
    document.documentElement.setAttribute('data-theme', dataTheme)
  </script>

  <!-- <link rel="stylesheet" href="./css/almostclassless.css"> -->
  <style>
    @font-face {
      font-family: Overpass-Light;
      src: url('./font/Overpass-Light.woff2') format('woff2');
    }

    @font-face {
      font-family: Overpass-Regular;
      src: url('./font/Overpass-Medium.woff2') format('woff2');
    }

    :root,
    [data-theme='light'] {
      --background-color: #ccc;
      --text-color: rgb(34, 34, 34);
      --link-color: rgb(126, 115, 159);
      background-color: var(--background-color);
    }

    [data-theme='dark'] {
      --background-color: rgb(51, 51, 51);
      --text-color: rgb(197, 197, 197);
      --link-color: rgb(132, 103, 222);
      background-color: var(--background-color);
    }

    * {
      transition: color 0.5s, background-color 0.5s;
    }

    body {
      max-width: 1024px;
      margin: 0 auto;
      padding: 0 1rem;
      background-color: var(--background-color);
      color: var(--text-color);
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    label {
      font-family: Overpass-Regular;
    }

    h1,
    .browserTheme,
    .storageThemeName {
      color: var(--link-color);
    }

    button {
      background-color: var(--link-color);
      border: 1px solid black;
      border-radius: .5rem;
      color: var(--text-color);
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      padding: .25rem .5rem;
    }

    button:hover {
      filter: brightness(1.2)
    }

    input[type="checkbox"] {
      appearance: none;
      width: 1.2rem;
      height: 1.2rem;
      border-radius: 3px;
      border: 1px solid black;
      box-shadow: inset 0 0 0 0.185rem var(--background-color);
      background: var(--background-color);
      vertical-align: text-top;
    }

    input[type="checkbox"]:checked {
      background: var(--link-color);
    }
  </style>
</head>

<body>

  <h1>Web Apps Foundation</h1>

  <h2>Light Switch</h2>

  <h3><span class="storageTheme"></span></h3>
  <p style="display: flex;align-items: center;gap:.5rem;">
    <label for="saveLocalStorage">Save to Local Storage</label>
    <input type="checkbox" id="saveLocalStorage" name="saveLocalStorage" value="saveLocalStorage">
  </p>
  <p>
    <button onclick="reload()">reload</button>
  </p>
  <br>
  <h3>Your browser is currently in <span class="browserTheme"></span>.</h3>

  <p>
    <button class="toggleTheme"></button>
  </p>
  <br>


  <!-- END OF HTML -->

  <script>
    // define variables for the elements we need to manipulate
    const faviconEl = document.querySelector('link[rel="icon"]');
    const title = document.querySelector('title');
    const toggleThemeButton = document.querySelector('button.toggleTheme');
    const browserTheme = document.querySelector('.browserTheme');
    var storageTheme = document.querySelector('.storageTheme');
    var dataTheme = document.documentElement.getAttribute('data-theme', dataTheme)

    // define eventListener  
    toggleThemeButton.addEventListener('click', () => {
      // toggle dataTheme 
      // store localStorage
      // set the theme
      dataTheme = (dataTheme === 'light') ? 'dark' : 'light'
      storeLocal()
      setTheme()
    });

    // run the functions on page load
    document.addEventListener('DOMContentLoaded', () => {
      setTheme()
    });

    //
    // store theme in localStorage (if checkbox checked) 
    // reload the page
    //
    function reload() {
      storeLocal()
      window.location.reload();
    }

    //
    // store theme in localStorage (if checkbox checked)
    //
    function storeLocal() {
      if (saveLocalStorage.checked) {
        window.localStorage.setItem('data-theme', dataTheme);
      } else {
        window.localStorage.removeItem('data-theme');
      }
    }

    //
    // Set the theme based on the data-theme attribute
    //
    function setTheme() {
      let themeInStorage = window.localStorage.getItem('data-theme');
      if (themeInStorage) {
        storageTheme.innerHTML = 'Theme stored in localStorage: <span class="storageThemeName">' + themeInStorage + '</span>';
      } else {
        storageTheme.innerHTML = 'no Theme stored in localStorage'
      }

      if (dataTheme === 'dark') {
        browserTheme.innerHTML = '<b>dark</b> mode';
        toggleThemeButton.innerText = 'Switch to Light';
        title.innerText = 'Dark Mode';
        // prism.setAttribute('href', './css/prism-dark.css');
        faviconEl.setAttribute('href', 'img/favicon-dark.png');
      } else {
        browserTheme.innerHTML = '<b>light</b> mode, or no mode is set';
        toggleThemeButton.innerText = 'Switch to Dark';
        title.innerText = 'Light Mode';
        // prism.setAttribute('href', './css/prism-light.css');
        faviconEl.setAttribute('href', 'img/favicon-light.png');
      }
      document.documentElement.setAttribute('data-theme', dataTheme);

    }


  </script>




</body>

</html>